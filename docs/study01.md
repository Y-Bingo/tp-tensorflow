# 机器学习

## 机器学习是什么？

-   机器学习是对能通过*经验*自动改进的计算机算法的研究
-   机器学习是用*数据*或以往的*经验*，以此优化计算机程序的性能标准

机器学习例子：

-   中世纪平均脚长
-   线性回归（ y = fn(x), 对x进行预测）
-   逻辑回归（ z = fn(x,y), 对一个值进行预测）
-   图片分类（ z = fn(x,y,k.....), 对一组数据进行预测）
-   语音助手（ 同上，语音也就是一组数据）

## 为什么要用机器学习？

-   有些棘手的问题只能用机器学习来解决
    - 例：图片里面有猫的概率
-   获取数据比编写规则更加容易
    - 例：编写翻译软件
-   GPU 等计算能力显著提升
    - 神经网络算法，在上世纪已经出现，但是只有在最近才得到引用，因为当时计算机的算力不足以支撑

## 机器学习如何运作？
- 神经网络
- 决策树、支持向量机、贝叶斯分类器、强化学习 

# 神经网络

## 什么是神经网络

> 指的是人工神经网络，人工神经网络是一种运算模型（就是输入输出的映射），由大量的节点（或神经元）之间互联构成

```mind
五官 -> 形象 -> 满意度
身材 -> 财富 -> 满意度
学历 -> 品质 -> 满意度
家境 -> 有趣 -> 满意度
```

#### 总结
- 每个神经元里存储这若干权重（weight）、偏置（bias）和一个激活函数（activation）
- 输入乘上权重加上偏置，经过激活函数得到输出
- 激活函数用于添加一些非线性变换
- 神经网络通常包括一个输入层、若干隐藏正、一个输出层
- 输入层通常不用于计算神经网络的层数

## 什么是神经网络的训练

> 给大量输入和输出，算出神经网络里所有神经元的权重、偏置，然后给定新的输入，可以算出新的输出
> 在机器学习里输入输出被称为*特征*和*标签*，大量输入输出被称为训练集

## 如何训练神经网络

1. 初始化： 随机生成一些权重和偏置
2. 计算损失： 给定特征，计算标签，得到它与真是标签的差距
3. 优化： 微调权重和偏置，使损失变小

## 前向传播与反向传播

-   前向传播：将训练数据的特征送入网络，得到标签
-   反向传播：计算损失并优化

## 如何计算损失

-   使用损失函数
-   均方误差、对数损失、交叉熵....
-   了解原理即可，直接使用第三方库提供的

## 如何优化

-   使用优化器
-   随机梯度下降、Adam
-   了解原理即可，直接使用第三方库提供的

# Tensorflow.js

## Tensorflow.js 是什么？

-   一个 javascript 实现的机器学习库
-   可以直接在浏览器和 Node.js 中使用机器学习技术
-

## Tensorflow.js 具体功能

-   运行现有的模型
-   重新训练现有的模型
-   使用 javascript 开发机器学习模型

应用：

-   emoji scavenger hunt
-   声音命令
-   使用摄像头控制吃豆人

## Tensorflow 安装

### 在浏览器中安装

#### 使用 script 标签

```html
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
```

#### 使用 NPM 包安装，并使用 Parcel 或 Webpack 构建 （推荐）

```shell
npm i - D @tensorflow/tfjs
```

### 在 node 中安装

#### 安装带有原生 C++ 绑定的 Tensorflow.js （性能好）

#### 安装纯 javascript 版本，这是性能方面最慢的选项（浏览器安装相似）

## 什么是 Tensor

-   中文名叫张量
-   张量是向量和矩阵更高维度的推广
-   相当于多维数组（类似嵌套数组）

## Tensor 和 机器学习的关系？

-   神经网络是什么样子？
-   如果让你设计神经网络的数据结构，你会怎么样设计？

## 神经网络数据结构设计

-   每个神经元是一个数组
-   以层为单位
-   神经网络的每一层要存储 N 维数据
-   N 层的 For 循环运算
-   Tensor 作为高维数据结构完美解决以上问题

```javascript
// 传统 for 循环
const input = [1, 2, 3, 4];
const w = [
	[1, 2, 3, 4],
	[2, 3, 4, 5],
	[3, 4, 5, 6],
	[4, 5, 6, 7],
];
const output = [0, 0, 0, 0];
for (let i = 0; i < w.length; i++) {
	for (let j = 0; j < input.length; j++) {
		output[i] += input[j] * w[i][j];
	}
}

console.log(output);

// 使用 tensor
tf.tensor(w).dot(tf.tensor(input)).print();
```
